---
import { AstroError } from 'astro/errors'
import { Icon } from 'astro-icon/components'

interface Props {
	type?: (typeof types)[number]
	title?: string
}

const defaultTitle = {
	info: '提示',
	note: '注意',
	caution: '警告',
	danger: '危險',
} as const

const icons = {
	info: 'lucide:lightbulb',
	note: 'lucide:circle-alert',
	caution: 'lucide:triangle-alert',
	danger: 'lucide:octagon-alert',
} as const

const types = ['info', 'note', 'caution', 'danger'] as const

const { type = 'note', title = defaultTitle[type] } = Astro.props

if (!types.includes(type)) {
	throw new AstroError(
		`Invalid \`type\` prop. (@Components/mdx/Aside.astro) \n`,
		`Input: ${JSON.stringify(type)}\nExpected: One of ${types.map((i) => JSON.stringify(i)).join(', ')}`
	)
}
---

<aside class:list={`aside aside-${type}`}>
	<div class="aside-container">
		<div class="not-prose flex items-center font-semibold">
			<Icon name={`${icons[type]}`} size={22} />
			<p class="pl-1.5 text-lg">{title}</p>
		</div>
		<div class="aside-content">
			<slot />
		</div>
	</div>
</aside>

<style>
	@reference "../../styles/global.css";
	:root {
		--bg-green: #d6efdf;
	}
	.aside {
		@apply my-5 rounded-lg p-5;
		* {
			@apply dark:text-foreground/70;
		}
	}
	.aside-info {
		@apply bg-(--bg-green);
		p code {
			@apply bg-green-50 dark:bg-green-50 dark:ring-black/10;
		}
	}
	.aside-note {
		@apply bg-blue-100;
		p code {
			@apply bg-blue-50 dark:bg-blue-50 dark:ring-black/5;
		}
	}
	.aside-caution {
		@apply bg-orange-100;
		p code {
			@apply bg-orange-50 dark:bg-orange-50 dark:ring-black/5;
		}
	}
	.aside-danger {
		@apply bg-red-100;
		p code {
			@apply bg-red-50 dark:bg-red-50 dark:ring-black/5;
		}
	}
	.aside-content {
		*:first-child {
			@apply mt-3;
		}
		*:last-child {
			@apply mb-0;
		}
		* {
			@apply my-3;
		}
	}
</style>
